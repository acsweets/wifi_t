# WiFi-T 测试指南

## 测试环境
- 网络：192.162.1.x 网段
- 设备：Android 手机
- 协议：WebSocket + mDNS

## 功能测试

### 1. 基础连接测试

#### 准备工作
1. 确保两台设备连接到同一WiFi网络（192.162.1.x网段）
2. 在两台设备上安装WiFi-T应用

#### 测试步骤
1. **设备A（接收端）**：
   - 打开应用，切换到"接收端"Tab
   - 点击"启动服务器"按钮
   - 确认看到本机IP地址显示
   - 确认看到"🔡 正在广播 mDNS 服务"提示

2. **设备B（发送端）**：
   - 打开应用，切换到"发送端"Tab
   - 点击"搜索设备"按钮
   - 观察搜索过程和结果

### 2. mDNS 发现测试

#### 测试场景1：mDNS自动发现
- 发送端点击"搜索设备"
- 应该能发现局域网内的HTTP服务
- 查看控制台日志确认mDNS查询过程

#### 测试场景2：网络扫描备用方案
- 如果mDNS未发现设备
- 系统会自动扫描192.162.1.x网段
- 扫描常用IP地址的8080端口

### 3. 通信功能测试

#### 文本消息测试
1. 建立连接后，在发送端输入文本消息
2. 点击发送按钮
3. 确认接收端能实时收到消息
4. 测试接收端回复功能

#### 图片传输测试
1. 在发送端点击图片按钮
2. 选择一张图片
3. 确认图片能成功传输到接收端
4. 验证图片显示正确

## 调试信息

### 控制台日志
运行时查看以下关键日志：
```
Starting mDNS discovery for _http._tcp.local
Found PTR record: [服务名]
Found SRV record: [目标:端口]
Found IP: [IP地址]
Added device: [设备名] at [IP:端口]
mDNS discovery completed, found [数量] devices
```

### 网络扫描日志
```
No devices found via mDNS, starting network scan...
Scanning 192.162.1.x network for port 8080...
Found device at [IP地址]
Network scan completed, found [数量] total devices
```

## 常见问题排查

### 1. 搜索不到设备
- 检查两台设备是否在同一网络
- 确认接收端已启动服务器
- 查看控制台是否有mDNS相关日志
- 尝试手动输入IP连接

### 2. 连接失败
- 确认IP地址正确
- 检查防火墙设置
- 确认8080端口未被占用
- 重启应用重试

### 3. 消息传输问题
- 检查WebSocket连接状态
- 确认网络稳定性
- 查看错误日志

## 性能指标

### 发现速度
- mDNS发现：2-5秒
- 网络扫描：5-10秒
- 总超时时间：15秒

### 连接性能
- WebSocket连接建立：< 1秒
- 文本消息延迟：< 100ms
- 图片传输时间：取决于图片大小

## 测试结果记录

### 设备信息
- 设备A型号：_______
- 设备B型号：_______
- 网络环境：192.162.1.x
- WiFi信号强度：_______

### 功能测试结果
- [ ] mDNS自动发现
- [ ] 网络扫描发现
- [ ] WebSocket连接
- [ ] 文本消息传输
- [ ] 图片消息传输
- [ ] 双向通信

### 性能测试结果
- 设备发现时间：_____ 秒
- 连接建立时间：_____ 秒
- 消息传输延迟：_____ ms

## 下一步优化

基于测试结果，可以考虑以下优化：
1. 调整mDNS查询超时时间
2. 优化网络扫描范围
3. 增加连接重试机制
4. 改进错误提示信息